"José, estou utilizando 'stream' para processar os subprotocolos e manufaturas e não estou validando explicitamente a sua existência. Isso pode resultar em 'NullPointerException' se, em algum caso, não houver um subprotocolo ou manufatura. Você pode confirmar se, independentemente do CNPJ, sempre haverá um subprotocolo e uma manufatura associados? Isso me ajudará a entender se preciso adicionar validações extras.
